```{r}
library(dplyr)
library(cowplot)
io = import('io')

config = io$read_yaml("../../config.yaml")
focal = io$load("../../data/focal.RData")

df = lapply(focal$estimate[config$cohorts], reshape2::melt) %>%
    bind_rows(.id="cohort") %>%
    mutate(name = sub("[A-Z]+", "", name),
           name = factor(name, levels=gtools::mixedsort(unique(name))))

y_labels = seq_along(levels(df$name))
y_labels[(y_labels-1) %% 5 != 0] = ""

ggplot(df) +
    geom_vline(xintercept=1:10, linetype="dotted", color="grey") +
    ggstance::geom_boxploth(aes(x=value, y=name, fill=cohort),
                            outlier.shape=1, outlier.size=0.2, outlier.alpha=0.5) +
    facet_grid(cohort ~ ., scales="free", space="free_y") +
    guides(fill=FALSE) +
    scale_x_continuous(trans="log2", breaks=1:10) +
    scale_y_discrete(labels=y_labels) +
    labs(x = "DNA copies of segment",
         y = "Regions of focal amplification/deletion (RACS)")
```
