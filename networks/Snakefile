configfile: "../config.yaml"

mem = {
    'TFbinding' : 1024,
    'aracne' : 10240,
    'genenet' : 102400
}

rule all:
    input:
        expand("{method}/{cohort}.RData", method=config['methods'], cohort=config['cohorts'])

rule network:
    input:
        rscript = "network.r"
    output:
        data = "{method}/{cohort}.RData"
    resources:
        mem = lambda wc: mem[wc.method] if wc.method in mem.keys() else 40960,
        walltime = 48*60
    shell:
        "Rscript {input.rscript}"
            " --cohort {wildcards.cohort}"
            " --method {wildcards.method}"
            " --outfile {output.data}"
